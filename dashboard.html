<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏£‡∏π</title>
  <style>
    body { font-family: "Prompt", sans-serif; background: #fdfdfd; color: #333; padding: 20px; }
    h1, h2 { text-align: center; color: #4b0082; }
    table { width: 100%; border-collapse: collapse; margin: 20px 0; }
    table, th, td { border: 1px solid #ccc; }
    th, td { padding: 10px; text-align: center; }
    th { background: #f0e6ff; }
    tr:nth-child(even) { background: #fafafa; }
    .comments { text-align: left; font-size: 0.9em; color: #555; }
  </style>
</head>
<body>
  <h1>üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏£‡∏π</h1>

  <h2>‡∏Ñ‡∏£‡∏π‡∏ß‡∏¥‡∏ä‡∏≤</h2>
  <table id="subjectsTable">
    <thead>
      <tr>
        <th>‡∏Ñ‡∏£‡∏π (‡∏ß‡∏¥‡∏ä‡∏≤)</th>
        <th>‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</th>
        <th>‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <h2>‡∏Ñ‡∏£‡∏π‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ä‡∏±‡πâ‡∏ô</h2>
  <table id="homeroomsTable">
    <thead>
      <tr>
        <th>‡∏´‡πâ‡∏≠‡∏á</th>
        <th>‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const API_URL = "https://script.google.com/macros/s/AKfycbx7zoW9S4ulivPPwSLOWLKLHuyE16IkWkGAsrFrBktgof0ta5Q9jDW1Fb3YOJjo4y4i/exec";

    async function loadSummary() {
      try {
        const res = await fetch(API_URL);
        const data = await res.json();

        // --- ‡∏Ñ‡∏£‡∏π‡∏ß‡∏¥‡∏ä‡∏≤ ---
        const subjBody = document.querySelector("#subjectsTable tbody");
        data.subjects.forEach(row => {
          let tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${row.teacher_subject}</td>
            <td>${row.avg}</td>
            <td class="comments">${row.comments.join("<br>")}</td>
          `;
          subjBody.appendChild(tr);
        });

        // --- ‡∏Ñ‡∏£‡∏π‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ä‡∏±‡πâ‡∏ô ---
        const homeBody = document.querySelector("#homeroomsTable tbody");
        data.homerooms.forEach(row => {
          let tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${row.homeroom}</td>
            <td>${row.avg}</td>
          `;
          homeBody.appendChild(tr);
        });

      } catch (err) {
        console.error("‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:", err);
      }
    }

    loadSummary();
  </script>
</body>
</html>
